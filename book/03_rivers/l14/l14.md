(lecture_14)=
# Surface flow into a river

## Water flow down slope

If we are to model fluid flows, we need to assess the dominant controls on the dynamics.
With water flowing downhill on the land surface, the down slope force of gravity is balanced by either the inertia of the fluid or the friction force from the ground on the fluid.
The inertia represents the force required to speed up or slow down the flow;
as fluid moves over the land, it may change direction for example, over some length scale $h$ comparable to the depth of the flow,
and this requires a time $\frac{L}{u}$, so the effective change in momentum divided by the time is

```{margin} Units!
:class: units
$$
y &= \mathrm{s} \\
h &= \mathrm{m} \\
u &= \mathrm{m~s^{-1}} \\
\rho &= \mathrm{kg~m^{-3}} \\
C_D &= \mathrm{unitless} \\
g &= \mathrm{m~s^{-2}} \\
\theta &= \mathrm{radians} \\
$$
```

```{math}
:label: runoff_balance
\frac{d (\rho u)}{dt} \sim \rho C_D \frac{u^2}{h}
```

where $C_D$ is the drag coefficient, $h$ the depth of the flow and $u$ is the flow speed.
Moody has published tables for the drag as a function of the roughness of the bed, but a representative value for $c$ may be 0.01-0.004.

If the gravity force down-slope is $\rho g \sin(\theta)$ for a slope of angle $\theta$ then the flow speed $u$ will be of order

```{math}
:label: gravity_speed
u = \sqrt{\frac{gh}{C_D} \sin(\theta)}
```

and the flux per unit distance across the slope will be

```{margin} Units!
:class: units
$$
q &= \mathrm{m^{2}~s^{-1}} \\
$$
```

```{math}
:label: gravity_flux
q = h u
```

In contrast, for a very thin film, the viscous force from the ground will dominate the flow, and this has the form

```{margin} Units!
:class: units
$$
\mu = \mathrm{kg~m^{-1}~s^{-1}}
$$
```

```{math}
:label: viscous_force
\mu \approx \frac{u}{h^2}
```

where $\mu$ is the dynamic viscosity of the fluid, and again $h$ is the depth of the flow.
Matching this with the gravity force down slope we find

```{math}
:label: viscous_grav_balance
u = g \rho \sin(\theta) \frac{h^2}{2\mu}
```

With a flux

```{math}
:label: thin_film_flow
q = g \rho \sin(\theta) \frac{h^3}{6\mu} 
```

Taking the ratio of the inertial and viscous forces, we find

```{margin} Units!
:class: units
$$
\Re &= \mathrm{unitless} \\
$$
```

```{math}
:label: reynolds_derivation
\mathrm{Re} = \frac{\rho u h}{\mu}
```

which this is known as the **{term}`Reynolds number`**.
If $\mathrm{Re}$ is large it implies that the flow is dominated by the inertia.
This corresponds to deep or fast flow.
Shallower slow flow is more likely to have low Reynolds number and be controlled by the viscous drag.
To estimate the transition point we can find the flux for which the depth of the current is comparable in the inertia dominated and viscous dominated flow (see problem sheet).

Surface run off in mild rain fall is likely to follow the slow viscous drag, but as the flow increases there may be a transition to the inertial flow regime.

Surface run off in vegetated areas may be more accurately modelled in terms of a porous flow with the water moving around the plants and surface soil, which provide the effective porous media with an effective permeability k.
In this case, the flow speed will be of the form

```{margin} Units!
:class: units
$$
k &= \mathrm{m^2} \\
$$
```

```{math}
:label: vegetated
u = g \rho \sin(\theta) \frac{k}{\mu}
```

over the surface of the ground. The effective permeability may be quite high near the ground.

## 1D model of drainage into a river

In a catchment there are a series of drainage zones, each flowing into a stream and then into the river, in a hierarchical way.
This leads to the question of how to build a model for the whole drainage basin which is more complex that the idealised bucket model.
We also may use such a detailed model to assess the value of l in the model based on the more detailed physical processes in a more complete model.
To this end we consider the next step of development of the model which is to consider the drainage along the land from the watershed to a stream as shown in {numref}`surface_drainage`.

```{figure} ./figures/figure14.1.png
---
name: surface_drainage
figclass: margin-caption
width: 80%
---
A more detailed surface drainage model.
```

The speed of the flow down the slope may be given in terms of the permeable flow relation (Darcy law) for flow through crops, wooded land or other surfaces with considerable resistance.

```{margin} Units!
:class: units
$$
u &= \mathrm{m~s^{-1}} \\
\rho &= \mathrm{kg~m^{-3}} \\
g &= \mathrm{m~s^{-2}} \\
\theta &= \mathrm{radians} \\
\mu &= \mathrm{kg~m^{-1}~s^{-1}} \\
k &= \mathrm{m^2} \\
$$
```

```{math}
u = \rho g \sin{(\theta)} \frac{k}{\mu}
```

And the outflow $Q$ is given by $u S$, where $S$ is evaluated at the base of the surface flow zone, at the stream.

To relate this to the flow along the slope, we require a model of the change of the surface storage along the slope as the rain falls.
If we denote the surface storage as $S(x,t)$ then the change of surface storage in a length of slope $\mathrm{d}x$ over a time $\mathrm{d}t$ is given by the build up of rain $R~\mathrm{d}x~\mathrm{d}t$ minus the infiltration over this time, $I~\mathrm{d}x~\mathrm{d}t$, as well as the difference of the flow into the element, $u S(x,t)~\mathrm{d}t$ and the flow out of the element $u S~(x+\mathrm{d}x,t)~\mathrm{d}t$.

This leads to the balance:

```{margin} Units!
:class: units
$$
Q &= \mathrm{m^3~s^{-1}} \\
R, I &= \mathrm{m~s^{-1}} \\
S &= \mathrm{m^2} \\
L &= \mathrm{m} \\
$$
```

```{math}
S(x, t + \delta t) \delta x - S(x, t) \delta x = R \delta x \delta t - I \delta x \delta t + u S(x, t) \delta t - u S(x + \delta x, t) \delta t
```

And hence the equation:

```{math}
\frac{\partial S}{\partial t} = R - I - u \frac{\partial S}{\partial x}
```

Governing the change of surface storage along the surface from the watershed to the stream (in the direction of the flow along the surface).

We need to find the value of $S(L,t)$ at the point where the surface flow drains into the stream. To do this we seek a solution of the form:

```{margin} Units!
:class: units
$$
W &= \mathrm{m^2} \\
\eta &= \mathrm{m} \\
\tau &= \mathrm{s} \\
$$
```

```{math}
S(x,t) = W(\eta, \tau)
```

Where $\eta = x - u t$ and $\tau = t$.

This leads to the relations:

```{math}
\begin{align}
\frac{\partial W}{\partial t} &= - u \frac{\partial W}{\partial \eta} + \frac{\partial W}{\partial \tau} \\
\frac{\partial W}{\partial x} &= \frac{\partial W}{\partial \eta}
\end{align}
```

And the equation becomes:

```{math}
\frac{\partial W}{\partial \tau} = R - I
```

If we solve this equation on lines $\eta = \mathrm{constant}$, then we find that

```{math}
W(\eta, \tau) = W(\eta, 0) + (R - I) \tau
```

We want the solution when $x = L$ (i.e. the value of $S$ at the stream). The lines of $\eta = \mathrm{constant}$ are shown on the $x-t$ plane in {numref}`eta_constant`. 

```{figure} ./figures/figure14.2.png
---
name: eta_constant
figclass: margin-caption
width: 80%
---
Lines of $\eta = \mathrm{constant}$ on the $x-t$ plane
```

There are two regions â€“ the set of points where $x = L$ and $t \lt L/u$, for which lines $\eta = \mathrm{constant}$ start on the x-axis at time = 0 (e.g. the line starting at $x_0$), and for each of these lines, the time at which they reach the distance $x = L$ is $(L-x_0)/u$. This is the time for the line of constant $\eta$ starting at $x=x_0$ at $t=0$ to reach the line $x = L$, and so the value of $W$ (and hence $S$) at time $t$ and at $x = L$ is $w=(R-I)t$.

The other region corresponds to the points $x=L$ and $t \gt L/u$. In this region the lines of constant $\eta$ which reach $x = L$ for $t \gt L/u$ start at $x = 0$ at a time $t0 \gt 0$.
Hence, the time to reach the line $x = L$ is $L/u$, and so at $x = L$, $w = (R-I) L/u$ if $t \gt L/u$.

As a result, the flux at $x = L$ is given by

```{math}
\begin{align}
u S &= u (R - I) t && t \lt L / u\\
&= (R - I) L && t \geq L / u
\end{align}
```

Matching this latter solution for equilibrium, with the equilibrium solution for the bucket model, we find that the parameter $\lambda$ in the bucket model is given by

```{math}
\lambda = u / L
```

and this is the time constant for reaching equilibrium between the surface water accumulation and flow into the streams.

