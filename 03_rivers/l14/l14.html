
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>4.2. 1D model of drainage into a river</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/admonitions.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"loader": {"load": ["[tex]/physics", "[tex]/ams"]}, "tex": {"packages": ["base", "physics", "ams"]}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.3. River flows" href="../l15/l15.html" />
    <link rel="prev" title="4.1. Catchment and drainage" href="../l13/l13.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../00_intro/intro/intro.html">
   1. Introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../00_intro/l1/l1.html">
     1.1. Course Overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../00_intro/l2/l2.html">
     1.2. Where does the energy come from on Earth?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../00_intro/l3/l3.html">
     1.3. The Carbon Cycle
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../01_groundwater/intro/intro.html">
   2. Groundwater
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../01_groundwater/l4/l4.html">
     2.1. Groundwater Systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../01_groundwater/l5/l5.html">
     2.2. Why water moves beneath the surface
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../01_groundwater/l6/l6.html">
     2.3. How we measure and understand water movement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../01_groundwater/l7/l7.html">
     2.4. Groundwater challenges and sustainable groundwater
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../02_cryosphere/intro/intro.html">
   3. Cryosphere
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../02_cryosphere/l8/l8.html">
     3.1. Ice in the polar regions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../02_cryosphere/l9/l9.html">
     3.2. The growth and melting of ice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../02_cryosphere/l10/l10.html">
     3.3. The extent of sea ice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../02_cryosphere/l11/l11.html">
     3.4. Ice sheets and the flow of glacial ice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../02_cryosphere/l12/l12.html">
     3.5. Floating ice shelves and the flow of glacial ice
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../intro/intro.html">
   4. Surface water and Flooding
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../l13/l13.html">
     4.1. Catchment and drainage
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     4.2. 1D model of drainage into a river
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../l15/l15.html">
     4.3. River flows
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../l16/l16.html">
     4.4. Reservoirs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../l17/l17.html">
     4.5. Flood waves
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../l18/l18.html">
     4.6. Flooding
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../04_atmosphere/intro/intro.html">
   5. Air Pollution and Atmospheric Chemistry
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../04_atmosphere/l19/l19.html">
     5.1. An overview of the atmosphere
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../04_atmosphere/l20/l20.html">
     5.2. Air pollution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../04_atmosphere/l21/l21.html">
     5.3. The chemistry of pollutants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../04_atmosphere/l22/l22.html">
     5.4. Aerosols
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../04_atmosphere/l23/l23.html">
     5.5. Air pollution and climate – indirect effects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../04_atmosphere/l24/l24.html">
     5.6. Air pollution and climate – direct effects
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../05_globalenvironment/intro/intro.html">
   6. Global Environment
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../05_globalenvironment/l26/l26.html">
     6.1. Introduction
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../reference/glossary.html">
   7. Glossary
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/03_rivers/l14/l14.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#flow-speed">
   Flow speed
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deriving-the-advection-equation">
   Deriving the advection equation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solving-the-advection-equation">
   Solving the advection equation
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>1D model of drainage into a river</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#flow-speed">
   Flow speed
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deriving-the-advection-equation">
   Deriving the advection equation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solving-the-advection-equation">
   Solving the advection equation
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="d-model-of-drainage-into-a-river">
<span id="lecture-14"></span><h1><span class="section-number">4.2. </span>1D model of drainage into a river<a class="headerlink" href="#d-model-of-drainage-into-a-river" title="Permalink to this headline">#</a></h1>
<p>In a catchment there are a series of drainage zones, each flowing into a stream and then into the river, in a hierarchical way.
This leads to the question of how to build a model for the whole drainage basin which is more complex that the idealised bucket model.
We also may use such a detailed model to assess the value of <span class="math notranslate nohighlight">\(\lambda\)</span> in the model based on the more detailed physical processes in a more complete model.
To this end we consider the next step of development of the model which is to consider the drainage along the land from the watershed to a stream as shown in <a class="reference internal" href="#surface-drainage"><span class="std std-numref">Fig. 4.10</span></a>.</p>
<figure class="margin-caption align-default" id="surface-drainage">
<a class="reference internal image-reference" href="../../_images/figure14.1.png"><img alt="../../_images/figure14.1.png" src="../../_images/figure14.1.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.10 </span><span class="caption-text">A more detailed surface drainage model showing the fractal nature of drainage networks.</span><a class="headerlink" href="#surface-drainage" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<section id="flow-speed">
<h2>Flow speed<a class="headerlink" href="#flow-speed" title="Permalink to this headline">#</a></h2>
<p>Extending our model from 0D into 1D, adding a spatial dependence, we are going to need to assess the dominant controls on the fluid dynamics.
The speed of the flow down the slope may be given in terms of the permeable flow relation; D’Arcy’s law, which we discussed in <a class="reference internal" href="../../01_groundwater/l5/l5.html#lecture-5"><span class="std std-numref">Section 2.2</span></a>.
Flow through crops, wooded land or other surfaces provide the effective porous media with an effective permeability, <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>In this case, the flow speed will be of the form</p>
<aside class="units margin sidebar">
<p class="sidebar-title">Units!</p>
<div class="math notranslate nohighlight">
\[\begin{split}
u &amp;= \mathrm{m~s^{-1}} \\
\rho &amp;= \mathrm{kg~m^{-3}} \\
g &amp;= \mathrm{m~s^{-2}} \\
\theta &amp;= \mathrm{radians} \\
\mu &amp;= \mathrm{kg~m^{-1}~s^{-1}} \\
k &amp;= \mathrm{m^2} \\
\end{split}\]</div>
</aside>
<div class="math notranslate nohighlight" id="equation-vegetated">
<span class="eqno">(4.5)<a class="headerlink" href="#equation-vegetated" title="Permalink to this equation">#</a></span>\[u = \rho g \sin{(\theta)} \frac{k}{\mu}\]</div>
<p>over the surface. The effective permeability may be quite high near the ground.</p>
</section>
<section id="deriving-the-advection-equation">
<h2>Deriving the advection equation<a class="headerlink" href="#deriving-the-advection-equation" title="Permalink to this headline">#</a></h2>
<p>We now wish to derive a relation describing how water is stored on and moves down our slope.
We will do this by considering the flow of water into and out of a small space element on our slope, <span class="math notranslate nohighlight">\(\delta x\)</span>,
as shown in <a class="reference internal" href="#surface-flow"><span class="std std-numref">Fig. 4.11</span></a>.</p>
<figure class="margin-caption align-default" id="surface-flow">
<a class="reference internal image-reference" href="../../_images/figure14.2.png"><img alt="../../_images/figure14.2.png" src="../../_images/figure14.2.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.11 </span><span class="caption-text">A schematic model showing how surface water, <span class="math notranslate nohighlight">\(S\)</span>, flows downhill towards a stream.</span><a class="headerlink" href="#surface-flow" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The total amount of water stored in our space element is denoted by <span class="math notranslate nohighlight">\(S\)</span>.
The sources of water to our element will be flow in from up slope, and rain, <span class="math notranslate nohighlight">\(R\)</span>.
The sinks of water from our element will be flow out of the element down slope, and infiltration into the ground, <span class="math notranslate nohighlight">\(I\)</span>.</p>
<p>The flow, <span class="math notranslate nohighlight">\(Q(x,t)\)</span>, at a point is calculated as the product of the amount of water <span class="math notranslate nohighlight">\(S\)</span>, multiplied by its speed <span class="math notranslate nohighlight">\(u\)</span>.
Given that our speed down the slope, <span class="math notranslate nohighlight">\(u\)</span>, is constant in this formulation, we can use our diagram in <a class="reference internal" href="#surface-flow"><span class="std std-numref">Fig. 4.11</span></a> to identify the flow in from up-slope as <span class="math notranslate nohighlight">\(u S(x,t)\)</span>
and the flow out down-slope as <span class="math notranslate nohighlight">\(-u S(x+\delta x, t)\)</span>.</p>
<p>Therefore, balancing all inputs and outputs of water to our space element over a short period of time, <span class="math notranslate nohighlight">\(\delta t\)</span>, we get the relation:</p>
<aside class="units margin sidebar">
<p class="sidebar-title">Units!</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Q &amp;= \mathrm{m^3~s^{-1}} \\
R, I &amp;= \mathrm{m~s^{-1}} \\
S &amp;= \mathrm{m^2 \ (m^3 m^{-1})} \\
L &amp;= \mathrm{m} \\
\end{split}\]</div>
</aside>
<div class="math notranslate nohighlight">
\[(S(x, t + \delta t) - S(x, t)) \delta x = R \delta x \delta t - I \delta x \delta t - (u S(x + \delta x, t) - u S(x, t)) \delta t\]</div>
<p>And so dividing through by <span class="math notranslate nohighlight">\(\delta x\)</span> and <span class="math notranslate nohighlight">\(\delta t\)</span>, and then taking the limit in which <span class="math notranslate nohighlight">\(\delta x\)</span> and <span class="math notranslate nohighlight">\(\delta t\)</span> go to zero
gives us the differential equation</p>
<div class="math notranslate nohighlight" id="equation-advection-eqn">
<span class="eqno">(4.6)<a class="headerlink" href="#equation-advection-eqn" title="Permalink to this equation">#</a></span>\[\frac{\partial S}{\partial t} = R - I - u \frac{\partial S}{\partial x}\]</div>
<p>This is called the <strong>advection equation</strong> and it governs the change of surface storage along the surface from the watershed to the stream (in the direction of the flow along the surface).</p>
</section>
<section id="solving-the-advection-equation">
<h2>Solving the advection equation<a class="headerlink" href="#solving-the-advection-equation" title="Permalink to this headline">#</a></h2>
<p>To find the flux of water into the river, we need to evaluate <span class="math notranslate nohighlight">\(S(x,t)\)</span> at the river edge (i.e <span class="math notranslate nohighlight">\(x=L\)</span>).
Therefore we need to solve the advection in case.
Given that the advection equation has a characteristic speed <span class="math notranslate nohighlight">\(u\)</span>, we expect solutions that encode this.
In order to use this intuition, we can apply a coordinate transform that moves us into the frame of reference of a parcel of water moving down the slope at a speed <span class="math notranslate nohighlight">\(u\)</span>.</p>
<aside class="units margin sidebar">
<p class="sidebar-title">Units!</p>
<div class="math notranslate nohighlight">
\[\begin{split}
W &amp;= \mathrm{m^2} \\
\eta &amp;= \mathrm{m} \\
\tau &amp;= \mathrm{s} \\
\end{split}\]</div>
</aside>
<div class="math notranslate nohighlight">
\[S(x,t) = W(\eta, \tau)\]</div>
<p>Where <span class="math notranslate nohighlight">\(\eta = x - u t\)</span> and <span class="math notranslate nohighlight">\(\tau = t\)</span>.</p>
<p>This leads to the relations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\frac{\partial W}{\partial t} &amp;= - u \frac{\partial W}{\partial \eta} + \frac{\partial W}{\partial \tau} \\
\frac{\partial W}{\partial x} &amp;= \frac{\partial W}{\partial \eta}
\end{align}\end{split}\]</div>
<div class="dropdown admonition">
<p class="admonition-title">Derivation</p>
<p>We want to derive the new derivative relations for our coordinate transformation,
Therefore, writing out the total derivative in <span class="math notranslate nohighlight">\(W\)</span>:</p>
<div class="math notranslate nohighlight">
\[\dd{W} = \pdv{W}{\tau} \dd{\tau} + \pdv{W}{\eta} \dd{\eta}\]</div>
<p>We can then “divide through by <span class="math notranslate nohighlight">\(\dd{t}\)</span>”, which while not rigorous, is fine for a physical system like this one</p>
<div class="math notranslate nohighlight">
\[\pdv{W}{t} = \pdv{W}{\tau} \pdv{\tau}{t} + \pdv{W}{\eta} \pdv{\eta}{t}\]</div>
<p>Then evaluating the derivatives of our coordinate transform</p>
<div class="math notranslate nohighlight">
\[\pdv{\tau}{t} = 1 \quad \pdv{\eta}{t}=-u\]</div>
<p>and then substituting into our previous equation gives the required result</p>
<div class="math notranslate nohighlight">
\[\pdv{W}{t} = \pdv{W}{\tau} - u \pdv{W}{\eta}\]</div>
<p>We could then repeat this analysis to get the equivalent result for <span class="math notranslate nohighlight">\(\pdv{W}{x}\)</span>.</p>
</div>
<p>Substituting these relations into <a class="reference internal" href="#equation-advection-eqn">(4.6)</a> we get</p>
<div class="math notranslate nohighlight">
\[\frac{\partial W}{\partial \tau} = R - I\]</div>
<p>We can solve this equation by integrating with respect to <span class="math notranslate nohighlight">\(\tau\)</span> (recalling <span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(I\)</span> are constant).
This gives us a solution for a given (i.e. constant) value of <span class="math notranslate nohighlight">\(\eta\)</span>.</p>
<div class="math notranslate nohighlight">
\[W(\eta, \tau) = W(\eta, 0) + (R - I) \tau\]</div>
<p>Where <span class="math notranslate nohighlight">\(W(\eta, 0)\)</span> is our constant of integration representing the initial condition.
This allows us to construct a <strong>characteristic diagram</strong> for the system, showing solutions in the <span class="math notranslate nohighlight">\(x\)</span> - <span class="math notranslate nohighlight">\(t\)</span> plane, along lines of constant <span class="math notranslate nohighlight">\(\eta\)</span>.
This is shown in <a class="reference internal" href="#eta-constant"><span class="std std-numref">Fig. 4.12</span></a>.</p>
<p>We want the solution when <span class="math notranslate nohighlight">\(x = L\)</span> (i.e. the value of <span class="math notranslate nohighlight">\(S\)</span> at the stream), shown as the dashed line intersecting the <span class="math notranslate nohighlight">\(x\)</span> axis in <a class="reference internal" href="#eta-constant"><span class="std std-numref">Fig. 4.12</span></a>.</p>
<figure class="margin-caption align-default" id="eta-constant">
<a class="reference internal image-reference" href="../../_images/figure14.3.png"><img alt="../../_images/figure14.3.png" src="../../_images/figure14.3.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.12 </span><span class="caption-text">The characteristic diagram for the advection equation, showing lines of <span class="math notranslate nohighlight">\(\eta = \mathrm{constant}\)</span> on the <span class="math notranslate nohighlight">\(x\)</span> - <span class="math notranslate nohighlight">\(t\)</span> plane.</span><a class="headerlink" href="#eta-constant" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>There are two regions for the solution:</p>
<ul class="simple">
<li><p>Region 1. The set of points where <span class="math notranslate nohighlight">\(x = L\)</span> and <span class="math notranslate nohighlight">\(t \lt \frac{L}{u}\)</span>, for which lines <span class="math notranslate nohighlight">\(\eta = \mathrm{constant}\)</span> start on the x-axis at time = 0 (e.g. the line starting at <span class="math notranslate nohighlight">\(x_0\)</span>).
For each of these lines, the time at which they reach the distance <span class="math notranslate nohighlight">\(x = L\)</span> is <span class="math notranslate nohighlight">\(t = \frac{(L-x_0)}{u}\)</span>;
i.e. the time for the line of constant <span class="math notranslate nohighlight">\(\eta\)</span> starting at <span class="math notranslate nohighlight">\(x=x_0\)</span> at <span class="math notranslate nohighlight">\(t=0\)</span> to reach the line <span class="math notranslate nohighlight">\(x = L\)</span>.
Therefore the value of <span class="math notranslate nohighlight">\(W\)</span> (and hence <span class="math notranslate nohighlight">\(S\)</span>) at time <span class="math notranslate nohighlight">\(t\)</span> and at <span class="math notranslate nohighlight">\(x = L\)</span> is <span class="math notranslate nohighlight">\(W=(R-I)t\)</span>.</p></li>
<li><p>Region 2. The other region corresponds to the points <span class="math notranslate nohighlight">\(x=L\)</span> and <span class="math notranslate nohighlight">\(t \gt \frac{L}{u}\)</span>.
In this region the lines of constant <span class="math notranslate nohighlight">\(\eta\)</span> which reach <span class="math notranslate nohighlight">\(x = L\)</span> for <span class="math notranslate nohighlight">\(t \gt \frac{L}{u}\)</span> start at <span class="math notranslate nohighlight">\(x = 0\)</span> at a time <span class="math notranslate nohighlight">\(t_0 \gt 0\)</span>.
Hence, the time to reach the line <span class="math notranslate nohighlight">\(x = L\)</span> is <span class="math notranslate nohighlight">\(\frac{L}{u}\)</span>, and so at <span class="math notranslate nohighlight">\(x = L\)</span>, <span class="math notranslate nohighlight">\(W = (R-I) \frac{L}{u}\)</span> for <span class="math notranslate nohighlight">\(t \gt \frac{L}{u}\)</span>.</p></li>
</ul>
<p>As a result, the flux at <span class="math notranslate nohighlight">\(x = L\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
u S &amp;= u (R - I) t &amp;&amp; \mathrm{for} &amp;&amp; t \lt \frac{L}{u}\\
u S &amp;= (R - I) L &amp;&amp; \mathrm{for} &amp;&amp; t \geq \frac{L}{u}
\end{align}\end{split}\]</div>
<p>Matching this latter solution for equilibrium with the equilibrium solution for the bucket model, we can identify the parameter <span class="math notranslate nohighlight">\(\lambda\)</span> in the bucket model as</p>
<div class="math notranslate nohighlight">
\[\lambda = \frac{L}{u}\]</div>
<p>This is the time constant for reaching equilibrium between the surface water accumulation and flow into the streams.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./03_rivers/l14"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../l13/l13.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">4.1. </span>Catchment and drainage</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../l15/l15.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4.3. </span>River flows</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By the QES Team<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>